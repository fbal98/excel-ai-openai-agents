# Excel Agent Testing Plan

This plan outlines test cases to evaluate the enhanced Excel agent's robustness, adherence to prompt guidelines, and error handling capabilities.

## Test Cases

| # | Instruction                                                                                                | Expected Behavior / Outcome                                                                                                                                                              | Actual Result (Post-Implementation) | Notes                                                                 |
|---|------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|-----------------------------------------------------------------------|
| 1 | Set cell A1 in Sheet1 to 'Hello'.                                                                          | Success. Agent uses `set_cell_value_tool`. Final state: Sheet1!A1 contains "Hello". Report: "Set cell A1 in Sheet1 to 'Hello'."                                                              |                                     | Basic single step.                                                    |
| 2 | Create a sheet named 'Data'. In 'Data', set A1 to 'ID', B1 to 'Name'. Then set A2 to 1, B2 to 'Alice'. Then set A3 to 2, B3 to 'Bob'. | Success. Agent uses `create_sheet_tool`, then `set_cell_values_tool` (or multiple `set_cell_value_tool`). Final state: New sheet 'Data' exists with A1='ID', B1='Name', A2=1, B2='Alice', A3=2, B3='Bob'. Report: "Created sheet 'Data' and populated cells A1:B3." |                                     | Multi-step, requires state awareness.                                 |
| 3 | Create a table of users.                                                                                   | Success. Agent creates a new sheet (e.g., 'Users' or default 'SheetX'). Uses `set_cell_values_tool` to populate A1:C~3 with default headers ('ID', 'Name', 'Value1') and placeholder data. Report: "Created sheet 'Users' and populated table with default headers and 2 rows." |                                     | Tests default assumptions.                                            |
| 4 | *Setup: Ensure at least two sheets exist (e.g., 'Sheet1', 'Data').* Set A1 to 'Important' in the main sheet. | Agent asks minimal clarifying question: "Which sheet do you mean? Options: Sheet1, Data" (or similar). Waits for user response.                                                              |                                     | Tests ambiguity handling (requires clarification).                    |
| 5 | Set cells using an empty data map. (Requires crafting instruction to trigger empty data for `set_cell_values_tool`) | Failure. Agent attempts `set_cell_values_tool` with empty `data`. Tool returns error like "Tool 'set_cell_values_tool' failed: The 'data' dictionary cannot be empty." Agent reports this error. |                                     | Tests tool-level input validation (empty data).                       |
| 6 | Delete sheet 'NonExistentSheet'.                                                                           | Failure. Agent attempts `delete_sheet_tool`. Tool returns error like "Sheet 'NonExistentSheet' not found for deletion." Agent reports this error.                                          |                                     | Tests `excel_ops` error handling (non-existent resource).             |
| 7 | Set C1 to the sum of A1 and B1 in Sheet1.                                                                  | Success. Agent uses `set_cell_formula_tool`. Final state: Sheet1!C1 contains formula '=A1+B1' or '=SUM(A1,B1)'. Report: "Set formula in C1 on Sheet1."                                     |                                     | Tests formula setting.                                                |
| 8 | Make A1:B2 bold in Sheet1.                                                                                 | Success. Agent uses `set_range_style_tool` with `{'font': {'bold': True}}`. Final state: Cells A1, A2, B1, B2 in Sheet1 are bold. Report: "Applied bold style to range A1:B2 in Sheet1."     |                                     | Tests styling.                                                        |
| 9 | Save the workbook as 'test_output.xlsx'.                                                                   | Success. Agent uses `save_workbook_tool`. Final state: File 'test_output.xlsx' exists in the workspace root. Report: "Saved workbook to 'test_output.xlsx'."                               |                                     | Tests saving functionality.                                           |
| 10| Set the width of column C in 'Data' sheet to 25.                                                          | Success. Agent uses `set_column_width_tool`. Final state: Column C in 'Data' sheet has width 25. Report: "Set width of column C in 'Data' to 25."                                        |                                     | Tests column width setting.                                           |
| 11| Set the height of row 5 in 'Data' sheet to 30.                                                            | Success. Agent uses `set_row_height_tool`. Final state: Row 5 in 'Data' sheet has height 30. Report: "Set height of row 5 in 'Data' to 30."                                            |                                     | Tests row height setting.                                             |
| 12| Merge cells A5:C5 in 'Data' sheet.                                                                        | Success. Agent uses `merge_cells_range_tool`. Final state: Cells A5:C5 in 'Data' are merged. Report: "Merged cells A5:C5 in 'Data'."                                                     |                                     | Tests merging.                                                        |
| 13| Unmerge cells A5:C5 in 'Data' sheet.                                                                      | Success. Agent uses `unmerge_cells_range_tool`. Final state: Cells A5:C5 in 'Data' are unmerged. Report: "Unmerged cells A5:C5 in 'Data'."                                                 |                                     | Tests unmerging.                                                      |


## Post-Implementation Testing Process

1.  Execute the agent with each instruction listed above.
2.  Record the *Actual Result* observed in the table.
3.  Compare the *Actual Result* with the *Expected Behavior*.
4.  Analyze any discrepancies. Identify bugs, prompt tuning needs, or tool logic issues.
5.  Create follow-up tasks/issues in the project tracker for any necessary fixes or refinements.